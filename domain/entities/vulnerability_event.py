import uuid
from typing import Optional
from pydantic import BaseModel, Field
from domain.enums.vulnerability_impact import VulnerabilityImpact # Importamos el Enum

class VulnerabilityFoundEvent(BaseModel):
    """
    Represents the incoming Kafka event for a discovered vulnerability.
    """
    id: uuid.UUID = Field(default_factory=uuid.uuid4) # ID del evento de vulnerabilidad
    scan_id: uuid.UUID
    asset_id: uuid.UUID
    cve_id: str
    cvss_score: float
    
    # Impactos dimensionales de CVSS, usando el Enum
    confidentiality_impact: VulnerabilityImpact
    integrity_impact: VulnerabilityImpact
    availability_impact: VulnerabilityImpact
    
    # Podrías añadir más detalles si la metodología los requiere, ej.
    # description: Optional[str] = None
    # recommended_action: Optional[str] = None

    class Config:
        from_attributes = True